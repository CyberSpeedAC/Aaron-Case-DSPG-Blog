---
title: "Week Three Spiders"
author: "Aaron Case"
date: "2023-05-30"
categories: [Week Three, Code]
---

During week the I started to developing spiders to extract data from webpages. This example is capable from extracting data from the privided weblink and putting the data into a pandas data frame. However this example is nowhere near finished.

```{python,eval=FALSE, message=FALSE, warning=FALSE}
import pandas as pd
import scrapy
from scrapy.crawler import CrawlerProcess
from scrapy.utils.log import configure_logging

class FreshThymeBaconSpider(scrapy.Spider):
    name = 'Fresh Thyme Market Bacon Spider'

    def start_requests( self ):
        start_urls = ['https://ww2.freshthyme.com/sm/planning/rsid/951/results?q=Bacon&take=48&f=Category%3AHot+Dogs%2C+Bacon+%26+Sausage']
        for url in start_urls:
            yield scrapy.Request( url = url, callback = self.cardsParse)
    
    def cardsParse(self, response):
        #Fail safe for links
        try:
            #grabs all cards from list and saves the link to follow
            xpath = '//*[contains(@class,"Listing")]/div/a/@href'
            listCards = response.xpath(xpath)
            linklist.append(listCards.extract())
            for url in listCards:
                yield response.follow( url = url, callback = self.itemParse, meta={'link': url} )
        except AttributeError:
           pass
    
    def itemParse(self, response):
        #xpaths to the name and price
        nameXpath = '//*[contains(@class, "PdpInfoTitle")]/text()'
        priceXpath = '//*[contains(@class, "PdpMainPrice")]/text()'
        url = response.meta.get('link')
        #Grabs the name and price from the xpaths and adds them to the bacon list
        bacon.append({'bacon': response.xpath(nameXpath).extract(), 'price': response.xpath(priceXpath).extract()})

# Start
configure_logging()
bacon = []
linklist = []
process = CrawlerProcess()
process.crawl(FreshThymeBaconSpider)
process.start()
process.stop()
baconFrame = pd.DataFrame(bacon)
print(baconFrame)
```

![Output](posts/Aaron_C_Week3/SpiderExample.PNG){width="485"}
